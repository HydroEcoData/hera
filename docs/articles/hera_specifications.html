<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Request for Comment: Shared Design Principles for Creating and Deploying Classification Methods • hera</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Request for Comment: Shared Design Principles for Creating and Deploying Classification Methods">
<meta property="og:description" content="hera">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hera</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/hera_specifications.html">Request for Comment: Shared Design Principles for Creating and Deploying Classification Methods</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="hera_specifications_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Request for Comment: Shared Design Principles for Creating and Deploying Classification Methods</h1>
            
            <h4 class="date">2020-11-17</h4>
      
      
      <div class="hidden name"><code>hera_specifications.Rmd</code></div>

    </div>

    
    
<style>
img {
border: 0px;
outline: 0 ;
}
</style>
<p>WORK IN PROGRESS - Drafting</p>
<p><img src="images/heraverse_logo_2.png" style="width:60.0%"></p>
<p>WARNING: Blue sky thinking ahead</p>
<p>Keywords: collection, modelling, prediction, classification, forecast, scenario</p>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a><span class="header-section-number">1</span> Summary</h1>
<p>We propose all new tool development share a common set of design principles, interfaces and data structures.</p>
<p>Specifically, we propose an official collection of R packages designed to provide collaborative workflow for building and using classification tools. In turn, these packages will be integrated into a single package called ‘hera’. This provides a common interface to run classification. We expect this process will facilitate code re-use, faster integration and knowledge exchange between method developers and practitioners.</p>
</div>
<div id="motivation" class="section level1">
<h1 class="hasAnchor">
<a href="#motivation" class="anchor"></a><span class="header-section-number">2</span> Motivation</h1>
<p>UKTAG has guided the development of an impressive range of classification tools. This has involved many developers, researchers and experts dedicating their time and effort to creating tools to better understand pressures on the environment. We are confident that there are many future opportunities for collaboration and tool development in response to changing environmental pressures and improving scientific understanding. For instance, new tools for diagnosing pressures, updates to existing tools and catchment scale planning.</p>
<p>The aims of a shared design philosophy for WFD classification R packages include:</p>
<ul>
<li>Create a single user interfaces, similar data formats and operating procedures.</li>
<li>Allow outputs from multiple tools to be quickly generated and combined together.</li>
<li>Shorten the time between development and integration into Agencies systems.</li>
<li>Where possible, define common routes to accessing and sharing of reference data and predictor values.</li>
<li>Make it easier to share and re-use code for confidence, uncertainty and model suitability across current or future methods.</li>
<li>Share data quality standards and data validation code.</li>
<li>Apply similar approaches to code review, testing and documentation.</li>
</ul>
</div>
<div id="key-ideas" class="section level1">
<h1 class="hasAnchor">
<a href="#key-ideas" class="anchor"></a><span class="header-section-number">3</span> Key Ideas</h1>
<ul>
<li>Clearer path for researcher engagement and model development.</li>
<li>Provide common APIs / web services to allow agencies to integrate into existing databases.</li>
<li>Allowing researchers/consultancies to use the R packages directly or through a GUI.</li>
</ul>
<div id="preparing-for-change" class="section level2">
<h2 class="hasAnchor">
<a href="#preparing-for-change" class="anchor"></a><span class="header-section-number">3.1</span> Preparing for change</h2>
<p>In the next 10 years…</p>
<p>The ease and access to modelling tools means there is a proliferation of models, indices and metrics. We have seen many useful results from modelling techniques in weather forecasting, flood planning and climate change research. It is likely that our aquatic ecological models will be subsumed into a more large scale environmental and climate models. These ‘total environment’ models may for instance use climate change models to forecast impact on invertebrates, water-use models to predict the impact on fish or flooding models the impact on macrophytes. The outputs from which we be used to plan flood management, biodiversity improvements, carbon sequestering etc. Allowing multi-discipline assessment of impacts and trade-offs for each planning scenario and proposed measures - ensuring well-informed decisions-making.</p>
<p>All ecology data will be freely accessible and bundled together (along with chemistry, climate, meteorological, geological etc) and multiple models run across the same data, providing outputs on many aspects of ecology, chemistry, climate, flooding, biodiversity etc.</p>
<p>We assume Ecologist will upload fish counter data, plant DNA or aerial imagery, which will be ingested into the ‘lake’ of environmental data. A huge number of models and predictions will automatically run based, providing fresh insights in environmental harms, biodiversity trends, pressures and impacts. Regular summary reports (largely drafted automatically) provide new findings and forecasts to be discussed and addressed.</p>
<p>To make step towards this vision, the underlying design of a models and tools must be modular and easy to connect and integrate in a variety of ways.</p>
</div>
</div>
<div id="detailed-design" class="section level1">
<h1 class="hasAnchor">
<a href="#detailed-design" class="anchor"></a><span class="header-section-number">4</span> Detailed design</h1>
<p>To aid collaboration and to response to the changing environmentally pressures, we propose creating a joint research platform to share understanding on the environment while providing the software infrastructure to lighten the burden of more mundane tasks involved in maintaining and deploying new models and interfaces.</p>
<p>This is influenced by the work of climate change research and weather forecasting communities. And on-going work in the R community such as <a href="https://ropensci.org/">ropenSci</a>.</p>
<div id="groups" class="section level2">
<h2 class="hasAnchor">
<a href="#groups" class="anchor"></a><span class="header-section-number">4.1</span> Groups</h2>
<p>All UKTAG sub-groups and their nominated leads in the devolved agencies would contribute new method develops and tools to the shared collection of packages. Where tools are agency specific, these could also make use of the platform if required.</p>
</div>
<div id="organisation" class="section level2">
<h2 class="hasAnchor">
<a href="#organisation" class="anchor"></a><span class="header-section-number">4.2</span> Organisation</h2>
<p>Currently some model packages are shared on github for instance <a href="https://github.com/nsj3/darleq3">darleq3</a>, <a href="https://github.com/aquaMetrics/fcs2">fsc2</a>, <a href="https://github.com/aquaMetrics/rict">rict</a>. We propose these tools become part of official collection of packages that, overtime, integrate as key dependencies for the unifying ‘hera’ package.</p>
<p>As agencies commission new tools to be developed, researchers can upload their predictive variables, reference data and models into a central repo for easier collaboration.</p>
</div>
<div id="lots-of-datasets---one-underlying-data-structure" class="section level2">
<h2 class="hasAnchor">
<a href="#lots-of-datasets---one-underlying-data-structure" class="anchor"></a><span class="header-section-number">4.3</span> Lots of datasets - one underlying data structure?</h2>
<p>Ecological modelling relies on sampling. The samples come in a range of forms from points, transects, images, grabs, DNA etc. But the general feature of modelling is based on being able to predict what we expect to find from whatever sampling technique we deploy. The sample is the fundamental observation which we compare against our prediction. The samples are discreet and independent, either observed instantaneously or perhaps over a few minutes or hours (where dynamic changes are not significant).</p>
<p>Multiple samples can be aggregated to smooth variance but the sample still remains the fundamental building block. The sample could be a single pixel from an aerial image or a salmon moving through a fish counter. We still make predictions of what we expect this sample to be like even if the true picture only emerges after several samples are aggregated or compared.</p>
</div>
<div id="what-does-this-look-like" class="section level2">
<h2 class="hasAnchor">
<a href="#what-does-this-look-like" class="anchor"></a><span class="header-section-number">4.4</span> What does this look like?</h2>
<p>Below is an example of diatom records, invert data and river flow in a shared input format.</p>
<p>They share some reference/book keeping variables but not all. Ultimately, only one reference is needed which is a unique sample id. The other reference variables can be ‘nested’ or in others words there can be as many or a few as you like. These nested values could be sample type, collector, instrument details etc. Or variables later used for aggregation such as water body, river, geographic area etc. For example:</p>
<table class="table">
<thead><tr class="header">
<th align="right">sample_id</th>
<th align="left">nested meta data</th>
<th align="left">question</th>
<th align="right">response</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">192342</td>
<td align="left">date_taken</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">6.348</td>
</tr>
<tr class="even">
<td align="right">192342</td>
<td align="left">location_code</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">6.348</td>
</tr>
<tr class="odd">
<td align="right">192342</td>
<td align="left">location_description</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">6.348</td>
</tr>
<tr class="even">
<td align="right">192342</td>
<td align="left">water_body_id</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">6.348</td>
</tr>
<tr class="odd">
<td align="right">192342</td>
<td align="left">water_body_name</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">6.348</td>
</tr>
</tbody>
</table>
</div>
<div id="predictors" class="section level2">
<h2 class="hasAnchor">
<a href="#predictors" class="anchor"></a><span class="header-section-number">4.5</span> Predictors</h2>
<p>Predictive variables such as temperature, altitude, slope etc are also metadata can can be nested, as they are the same for each sample.</p>
</div>
<div id="observations" class="section level2">
<h2 class="hasAnchor">
<a href="#observations" class="anchor"></a><span class="header-section-number">4.6</span> Observations</h2>
<p>The observation comes in two parts, the unique name/id for what you are observing and the value associated with it. For clarity these variables are called ‘question’ and ‘response’. The question could be “Taxon name?” and the response “Brown Trout”. However, the question must be unique. As ‘Taxon name?’ will be different depending on what survey is being undertaken. So question_id and response_id are given to allow these to be unique with metadata to provide a more readable format.</p>
<p>UUID are used to provide unique IDs for this variables.</p>
<table class="table">
<colgroup>
<col width="6%">
<col width="12%">
<col width="4%">
<col width="77%">
</colgroup>
<thead><tr class="header">
<th align="right">sample_id</th>
<th align="left">determinand</th>
<th align="right">value</th>
<th align="left">meta_variables</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">6.348</td>
<td align="left">2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 94200.0, 91000.0, 60.0, 2.7, 2.0, NA, 10.0, 6.4, 21.7, 101.4, 58.0, 36.0, 3.0, NA, NA, NA, NA</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">whpt_aspt_abundance</td>
<td align="right">27.000</td>
<td align="left">2.0, 1.0, 1.0, 1.0, 1.0, 1.0, 94200.0, 91000.0, 60.0, 2.7, 2.0, NA, 10.0, 6.4, 21.7, 101.4, 58.0, 36.0, 3.0, NA, NA, NA, NA</td>
</tr>
</tbody>
</table>
</div>
<div id="data-input" class="section level2">
<h2 class="hasAnchor">
<a href="#data-input" class="anchor"></a><span class="header-section-number">4.7</span> Data input</h2>
<p>Data input is through mobile or internet connected devices. The question_id and related meta data is configured. Manual or automated data can be collected. As new WFD developments and updates requirements are identified, the lead contacts from the agencies and method developers are ‘on-boarded’ to explain the expectations and examples of building collaborative framework of packages. Where skill develop is required further training can be provided, or additional external or internal support from the agency commissioning the work. A workshop for lead data experts / R coders from each agency delivers institutional knowledge on how internally developed tools will fit with the design philosophy and expectations of how external researchers will collaborate on building new tools.</p>
</div>
<div id="model-platform" class="section level2">
<h2 class="hasAnchor">
<a href="#model-platform" class="anchor"></a><span class="header-section-number">4.8</span> Model platform</h2>
<p>There is no prescribed modelling program or software. Researchers can download the data provided and use any software they desire - as long as it has an API</p>
<p>Alternatively, if researchers can’t provide an api for others. The recommendation is to use R - which integrates more directly into the pipeline.</p>
<p>Once modelling is completed, the model object is saved and deployed. Any existing or future data collected using the platform will be run through the model at the sample level.</p>
<p>Researchers can then build tools to display and aggregate the sample level results as required (Waterbody, Year, Catchment etc). Where it would be possible to share techniques for producing Confidence of Class, assessment of data suitability and adjustment factors etc.</p>
</div>
<div id="hera" class="section level2">
<h2 class="hasAnchor">
<a href="#hera" class="anchor"></a><span class="header-section-number">4.9</span> hera</h2>
<p>Here we introduce a prototype package called <code>hera</code>. We propose agreement around hera providing a common set of functions for running each step required for classification:</p>
<ol style="list-style-type: decimal">
<li>Validate observations and predictor data.</li>
<li>Calculate indices and predictors (if observed indices and predictors not pre-calculated).</li>
<li>Predict expected indices score based on predictors provided.</li>
<li>Classify observed over expected and provide confidence of class.</li>
<li>Various reporting for water bodies or other aggregated classification results.</li>
<li>Report comparisons (compare years, up and downstream, previous tool versions etc).</li>
</ol>
<p>Breaking the tools down into small steps allows these functions to be developed independently. Much of the code and rules can be re-used for future tool development.</p>
<p>The examples below are based on ‘fake’ data, indices and classification methods and is just ‘dream code’ at the moment…</p>
<p>This demo dataset contains information on diatoms, fish and inverts:</p>
<pre><code>library(hera)
str(demo_data)
</code></pre>
<ol style="list-style-type: decimal">
<li>Validate predictors and observations are correct and within the bounds of the model:</li>
</ol>
<pre><code>
validations &lt;- validation(demo_data)
</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>We run this dataset through hera calculating observed indices required for each sample:</li>
</ol>
<pre><code>
indices &lt;- indices(demo_data)
head(indices)
</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>We can also predict reference indices for each sample:</li>
</ol>
<pre><code>
predictions &lt;- prediction(demo_data)
head(predictions)
</code></pre>
<ol start="4" style="list-style-type: decimal">
<li>Based on the predicted and observed indices - we classify each sample:</li>
</ol>
<pre><code>
class &lt;- classification(demo_data)
head(class)
</code></pre>
<ol start="5" style="list-style-type: decimal">
<li>We now aggregated the samples by season, year or multi-year as required:</li>
</ol>
<pre><code>
aggregate &lt;- aggregations(demo_data, c("year","season","waterbody"))
head(class)
</code></pre>
<ol start="6" style="list-style-type: decimal">
<li>We now run a report assesses samples from the same location for consistency. Note, that no report for fish is produced, the necessary adjustment/interpretation parameters have not been created for fish. This demonstrates that it is step by step process. Not all tools/models will have all the features development if not required or if not prioritized:</li>
</ol>
<pre><code>compare_report &lt;- compare(new_data, old_data)
compare_report
</code></pre>
<p>We now run a report assesses two samples assess a discharge (up and downstream):</p>
<pre><code>compare_report &lt;- compare(site_one, site_two)
compare_report
</code></pre>
</div>
<div id="sharing" class="section level2">
<h2 class="hasAnchor">
<a href="#sharing" class="anchor"></a><span class="header-section-number">4.10</span> Sharing</h2>
<p>hera allows multiple ecological elements to be assessed through the same interface. But not just the interface is shared. Other areas of the infrastructure are shared including:</p>
<ul>
<li>Reporting and comparison tools can also be shared between multiple elements.</li>
<li>Validation checks and other universally required mechanisms are shared and easily configurable for new models/methods.</li>
<li>Testing infrastructure.</li>
<li>Confidence of class and data suitability algorithms.</li>
</ul>
</div>
</div>
<div id="how-we-teach-this" class="section level1">
<h1 class="hasAnchor">
<a href="#how-we-teach-this" class="anchor"></a><span class="header-section-number">5</span> How we Teach This</h1>
<p>As new WFD developments and updates requirements are identified, the lead contacts from the agencies and method developers are ‘on-boarded’ to demonstrate the design principles and collaborative framework of packages. Where skill development is required further training can be provided, or additional external or internal support from the agency commissioning the work.</p>
<p>A workshop for lead data experts / R coders from each agency delivers institutional knowledge on how internally developed tools will fit with the shared design philosophy as well as seeting expectations for colloaboration with external researchers.</p>
</div>
<div id="alternatives" class="section level1">
<h1 class="hasAnchor">
<a href="#alternatives" class="anchor"></a><span class="header-section-number">6</span> Alternatives</h1>
</div>
<div id="unresolved-questions" class="section level1">
<h1 class="hasAnchor">
<a href="#unresolved-questions" class="anchor"></a><span class="header-section-number">7</span> Unresolved questions</h1>
<ul>
<li>Should all reference data be combined into a single repository / web service?</li>
<li>Should all predictor data be combined into a single repository / web service?</li>
</ul>
</div>
<div id="appendix" class="section level1">
<h1 class="hasAnchor">
<a href="#appendix" class="anchor"></a><span class="header-section-number">8</span> Appendix</h1>
<div id="input-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#input-formats" class="anchor"></a><span class="header-section-number">8.1</span> Input formats</h2>
<div id="fcs2-tool" class="section level3">
<h3 class="hasAnchor">
<a href="#fcs2-tool" class="anchor"></a><span class="header-section-number">8.1.1</span> FCS2 tool</h3>
<p>Demo input data format (truncated) and full list of column names</p>
<pre><code>  DataHeldBy SiteCode Alternative.site.code Repeat.check SiteName ...
1         EA   525052                    NA            N    13809 ...
2         EA   507441                    NA            Y    13810 ...
3         EA   525051                    NA            N    34611 ...
4         EA   122881                    NA            Y     5435 ...</code></pre>
<pre><code> [1] "DataHeldBy"                 "SiteCode"                  
 [3] "Alternative.site.code"      "Repeat.check"              
 [5] "SiteName"                   "Site.description"          
 [7] "Easting"                    "Northing"                  
 [9] "NGR"                        "SurveyDate"                
[11] "WBId"                       "WBName"                    
[13] "NumberOfRuns"               "SurveyArea"                
[15] "WetWidth"                   "Slope"                     
[17] "BarrierType"                "ImpassableBarriers"        
[19] "Sense.check.passed."        "CatchmentAreaUpstream"     
[21] "CatchmentDrainageDirection" "GeologyClass"              
[23] "Altitude"                   "DistanceFromSource"        
[25] "DistanceToSea"              "AnnualMeanFlow"            
[27] "AlkalinityValue"            "TotalPValue"               
[29] "DOCValue"                   "SuspendedSolidsValue"      
[31] "IOH.hydrometric.area"       "HydrometricAreaNo"         
[33] "LandUse.AgriculturalAreas"  "LandUse.ConiferousForests" 
[35] "LandUse.Wetlands"           "Substrate.Small"           
[37] "Substrate.Large"            "Substrate.Bedrock"         
[39] "Salmon_fry.Run1Total"       "Salmon_fry.Run2Total"      
[41] "Salmon_fry.Run3Total"       "Salmon_fry.Run4Total"      
[43] "Salmon_parr.Run1Total"      "Salmon_parr.Run2Total"     
[45] "Salmon_parr.Run3Total"      "Salmon_parr.Run4Total"     
[47] "Trout_fry.Run1Total"        "Trout_fry.Run2Total"       
[49] "Trout_fry.Run3Total"        "Trout_fry.Run4Total"       
[51] "Trout_parr.Run1Total"       "Trout_parr.Run2Total"      
[53] "Trout_parr.Run3Total"       "Trout_parr.Run4Total"      </code></pre>
</div>
<div id="darleq-tool" class="section level3">
<h3 class="hasAnchor">
<a href="#darleq-tool" class="anchor"></a><span class="header-section-number">8.1.2</span> Darleq tool</h3>
<p>Input data for DARLEQ3 tool is a list of dataframes. Here’s an example of input data format (truncated) and full list of column names</p>
<pre><code>         AC023A AC083A AC143A AC161A AC9999  AD009A   AM001A AM004A ...
SPR001 0.000000      0      0      0      0 0.31348 0.000000      0 ...
AUT001 0.000000      0      0      0      0 0.00000 0.000000      0 ...
SPR002 0.332226      0      0      0      0 0.00000 0.332226      0 ...
AUT002 0.000000      0      0      0      0 0.00000 0.000000      0 ...</code></pre>
<pre><code>  [1] "AC023A" "AC083A" "AC143A" "AC161A" "AC9999" "AD009A" "AM001A" "AM004A"
  [9] "AM011A" "AM012A" "AM013A" "AM084A" "AM9999" "AP001A" "AS001A" "AS003A"
 [17] "AU003A" "AU9999" "BR001A" "BR9999" "CA002A" "CA9999" "CC9999" "CI002A"
 [25] "CI005A" "CL001A" "CM004A" "CM006A" "CM007A" "CM009A" "CM013A" "CM022A"
 [33] "CM038A" "CM041A" "CM9999" "CN001A" "CO001A" "CO001B" "CO001C" "CO005A"
 [41] "CO010A" "CO9999" "CV001A" "CV005A" "CY003A" "CY011A" "CY019A" "CY9999"
 [49] "DD001A" "DE001A" "DP007A" "DP012A" "DP9999" "DT003A" "DT004A" "DT010A"
 [57] "DT021A" "DT022A" "DT9999" "EC001A" "EL001A" "EP9999" "EU002A" "EU009A"
 [65] "EU009C" "EU047A" "EU070A" "EU9999" "EY003A" "EY004A" "EY005A" "EY011A"
 [73] "EY015A" "EY016A" "EY017A" "EY9999" "FA021A" "FF001A" "FF002A" "FF9999"
 [81] "FR007A" "FR007C" "FR008A" "FR009A" "FR009B" "FR019A" "FR026A" "FR9999"
 [89] "FU001A" "FU002A" "FU037A" "GO001A" "GO003A" "GO004A" "GO006A" "GO013A"
 [97] "GO013C" "GO019A" "GO023A" "GO023B" "GO024C" "GO027A" "GO029A" "GO050A"
[105] "GO052A" "GO055A" "GO066A" "GO9999" "GY001A" "GY005A" "HA001A" "HN001A"
[113] "LU001A" "LU003A" "MA9999" "ME015A" "MR001A" "MR001B" "NA003A" "NA007A"
[121] "NA008A" "NA009A" "NA021A" "NA023A" "NA026A" "NA027A" "NA030A" "NA035A"
[129] "NA037A" "NA042A" "NA051A" "NA054A" "NA063A" "NA066A" "NA080A" "NA084A"
[137] "NA095A" "NA112A" "NA114A" "NA124A" "NA134A" "NA433A" "NA433D" "NA462A"
[145] "NA675A" "NA745A" "NA751A" "NA764A" "NA768A" "NA9999" "NE008A" "NI002A"
[153] "NI005A" "NI006A" "NI008A" "NI009A" "NI010A" "NI014A" "NI015A" "NI017A"
[161] "NI021A" "NI024A" "NI025A" "NI027A" "NI028A" "NI031A" "NI033A" "NI034A"
[169] "NI042A" "NI043A" "NI044A" "NI046A" "NI049A" "NI052A" "NI065A" "NI080A"
[177] "NI099A" "NI110A" "NI152A" "NI164B" "NI166A" "NI171A" "NI198A" "NI199A"
[185] "NI212A" "NI9999" "PE002A" "PI014A" "PI9999" "PS001A" "RC002A" "RE001A"
[193] "SA003A" "SA012A" "SL001A" "SL002A" "SR001A" "SR002A" "SS002A" "SS003A"
[201] "ST001A" "ST9999" "SU001A" "SU032A" "SU073A" "SU9999" "SY001A" "SY003A"
[209] "SY004A" "SY004B" "SY013A" "SY043A" "TA001A" "TA002A" "TE003A" "TF003A"
[217] "TF015A" "TF9999" "TH038A" "TU003A" "UN9994" "UN9995" "YH001A" "ZZZ834"
[225] "ZZZ835" "ZZZ842" "ZZZ844" "ZZZ846" "ZZZ847" "ZZZ852" "ZZZ859" "ZZZ866"
[233] "ZZZ869" "ZZZ871" "ZZZ872" "ZZZ885" "ZZZ887" "ZZZ888" "ZZZ893" "ZZZ895"
[241] "ZZZ896" "ZZZ897" "ZZZ900" "ZZZ901" "ZZZ905" "ZZZ907" "ZZZ908" "ZZZ910"
[249] "ZZZ911" "ZZZ912" "ZZZ920" "ZZZ921" "ZZZ922" "ZZZ923" "ZZZ926" "ZZZ927"
[257] "ZZZ939" "ZZZ941" "ZZZ949" "ZZZ953" "ZZZ980" "ZZZ982" "ZZZ985" "ZZZ986"
[265] "ZZZ987"</code></pre>
<pre><code>[1] "SampleID"    "SiteID"      "SAMPLE_DATE" "Alkalinity"  "Stream"     
[6] "Reach"      </code></pre>
</div>
<div id="rict" class="section level3">
<h3 class="hasAnchor">
<a href="#rict" class="anchor"></a><span class="header-section-number">8.1.3</span> RICT</h3>
<p>Here’s an example of input data format (truncated) and full list of column names</p>
<pre><code>         SITE      Waterbody Year NGR Easting Northing Altitude Slope ...
1 MYR-GB-01-R Waterbody name 2016  SE   94200    91000       60   2.7 ...
2 MYR-GB-01-R Waterbody name 2017  SE   94200    91000       60   2.7 ...
3 MYR-GB-01-R Waterbody name 2018  SE   94200    91000       60   2.7 ...
4 MYR-GB-05-R Waterbody name 2016  TL   92100    27200       15   1.3 ...</code></pre>
<pre><code> [1] "SITE"                             "Waterbody"                       
 [3] "Year"                             "NGR"                             
 [5] "Easting"                          "Northing"                        
 [7] "Altitude"                         "Slope"                           
 [9] "Discharge"                        "Velocity"                        
[11] "Dist_from_Source"                 "Mean_Width"                      
[13] "Mean_Depth"                       "Alkalinity"                      
[15] "Boulder_Cobbles"                  "Pebbles_Gravel"                  
[17] "Sand"                             "Silt_Clay"                       
[19] "Hardness"                         "Calcium"                         
[21] "Conductivity"                     "Spr_Season_ID"                   
[23] "Spr_TL2_WHPT_ASPT (AbW,DistFam)"  "Spr_TL2_WHPT_NTaxa (AbW,DistFam)"
[25] "Spr_Ntaxa_Bias"                   "Sum_Season_ID"                   
[27] "Sum_TL2_WHPT_ASPT (AbW,DistFam)"  "Sum_TL2_WHPT_NTaxa (AbW,DistFam)"
[29] "Sum_Ntaxa_Bias"                   "Aut_Season_ID"                   
[31] "Aut_TL2_WHPT_ASPT (AbW,DistFam)"  "Aut_TL2_WHPT_NTaxa (AbW,DistFam)"
[33] "Aut_Ntaxa_Bias"                  </code></pre>
</div>
</div>
<div id="input-formats-1" class="section level2">
<h2 class="hasAnchor">
<a href="#input-formats-1" class="anchor"></a><span class="header-section-number">8.2</span> Input formats</h2>
<div id="fcs2-example" class="section level3">
<h3 class="hasAnchor">
<a href="#fcs2-example" class="anchor"></a><span class="header-section-number">8.2.1</span> FCS2 example</h3>
<pre><code>  DataHeldBy SurveyDate SiteCode SiteName  WBId                   WBName ...
1         EA 03/09/2015   525052    13809 10675                          ...
2         EA 04/09/2015   507441    13810 10675 White Esk (u/s Rae Burn) ...
3         EA 03/09/2015   525051    34611 10676                          ...
4         EA 01/09/2015   122881     5435 10676            Garwald Water ...</code></pre>
<pre><code> [1] "DataHeldBy"                                 
 [2] "SurveyDate"                                 
 [3] "SiteCode"                                   
 [4] "SiteName"                                   
 [5] "WBId"                                       
 [6] "WBName"                                     
 [7] "All species WB EQR Bad %"                   
 [8] "All species WB EQR Poor %"                  
 [9] "All species WB EQR Moderate %"              
[10] "All species WB EQR Good %"                  
[11] "All species WB EQR High %"                  
[12] "All species WB EQR mean"                    
[13] "All species survey EQR Bad %"               
[14] "All species survey EQR Poor %"              
[15] "All species survey EQR Moderate %"          
[16] "All species survey EQR Good %"              
[17] "All species survey EQR High %"              
[18] "All species survey EQR mean"                
[19] "Salmon_fry WB EQR mean"                     
[20] "Salmon_fry survey EQR mean"                 
[21] "Salmon_fry observed total catch"            
[22] "Salmon_fry probability present"             
[23] "Salmon_fry expected total catch if present" 
[24] "Salmon_fry expected total catch"            
[25] "Salmon_parr WB EQR mean"                    
[26] "Salmon_parr survey EQR mean"                
[27] "Salmon_parr observed total catch"           
[28] "Salmon_parr probability present"            
[29] "Salmon_parr expected total catch if present"
[30] "Salmon_parr expected total catch"           
[31] "Trout_fry WB EQR mean"                      
[32] "Trout_fry survey EQR mean"                  
[33] "Trout_fry observed total catch"             
[34] "Trout_fry probability present"              
[35] "Trout_fry expected total catch if present"  
[36] "Trout_fry expected total catch"             
[37] "Trout_parr WB EQR mean"                     
[38] "Trout_parr survey EQR mean"                 
[39] "Trout_parr observed total catch"            
[40] "Trout_parr probability present"             
[41] "Trout_parr expected total catch if present" 
[42] "Trout_parr expected total catch"            </code></pre>
</div>
<div id="rict-example" class="section level3">
<h3 class="hasAnchor">
<a href="#rict-example" class="anchor"></a><span class="header-section-number">8.2.2</span> RICT example</h3>
<pre><code>  ROW        SITE YEAR FAIL
1  15 TST-NI-03-D 2018  ---
2   3 TST-NI-03-R 2018  ---
                                                             WARNING
1 You provided MSUBST: 6.6125, max value used to train model: 6.61. 
2 You provided MSUBST: 6.6125, max value used to train model: 6.61. 
  REPLACEMENT
1         ---
2         ---</code></pre>
<pre><code>         SITE YEAR      WATERBODY H_NTAXA_spr_aut G_NTAXA_spr_aut
1 TST-NI-01-R 2018 Waterbody name           96.61             3.3
2 TST-NI-02-R 2018 Waterbody name            4.51           28.34
3 TST-NI-03-R 2018 Waterbody name           83.04           15.63
4 TST-NI-04-R 2018 Waterbody name           99.27            0.72
  M_NTAXA_spr_aut ...
1            0.09 ...
2           48.65 ...
3            1.32 ...
4            0.01 ...</code></pre>
<pre><code> [1] "SITE"                              "YEAR"                             
 [3] "WATERBODY"                         "H_NTAXA_spr_aut"                  
 [5] "G_NTAXA_spr_aut"                   "M_NTAXA_spr_aut"                  
 [7] "P_NTAXA_spr_aut"                   "B_NTAXA_spr_aut"                  
 [9] "mostProb_NTAXA_spr_aut"            "NTAXA_aver_spr_aut"               
[11] "H_ASPT_spr_aut"                    "G_ASPT_spr_aut"                   
[13] "M_ASPT_spr_aut"                    "P_ASPT_spr_aut"                   
[15] "B_ASPT_spr_aut"                    "mostProb_ASPT_spr_aut"            
[17] "ASPT_aver_spr_aut"                 "mintawhpt_spr_aut_H_MINTA_"       
[19] "mintawhpt_spr_aut_G_MINTA_"        "mintawhpt_spr_aut_M_MINTA_"       
[21] "mintawhpt_spr_aut_P_MINTA_"        "mintawhpt_spr_aut_B_MINTA_"       
[23] "mintawhpt_spr_aut_mostProb_MINTA_"</code></pre>
</div>
<div id="darleq-data" class="section level3">
<h3 class="hasAnchor">
<a href="#darleq-data" class="anchor"></a><span class="header-section-number">8.2.3</span> Darleq data</h3>
<p>(list of dataframes)</p>
<pre><code>       N_TDI5LM N2_TDI5LM Max_TDI5LM   TDI5LM  eTDI5LM
SPR001       41     12.39      16.93 55.60483 68.49447
AUT001       23      3.09      51.57 70.01608 68.49447
SPR002       55     13.14      20.93 70.66666 69.28261
AUT002       39      7.69      26.91 66.08840 69.28261
SPR003       39      9.37      27.30 50.40770 65.48689
AUT003       32      5.87      37.14 39.65652 65.48689</code></pre>
<pre><code>   CoCB   ROM  CoCHG CoCMPB ROM_GM
43 0.00 20.41  98.43   1.57   1.57
33 0.00 39.91  96.99   3.01   3.01
42 0.00  0.00 100.00   0.00   0.00
41 0.00  0.00 100.00   0.00   0.00
36 0.21 87.48  12.56  87.44  12.56
35 0.00 28.74  86.12  13.88  13.88</code></pre>
<pre><code>[1] "TDI5LM"</code></pre>
<pre><code>$N_samples
[1] 100

$N_samples_gt_zero
[1] 100

$N_taxa
[1] 265

$N_taxa_gt_zero
[1] 265</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tim Foster.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
